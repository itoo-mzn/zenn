---
title: "Go ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«"
emoji: "ğŸŒŠ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Go"]
published: true
---

# ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°

ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ã¯ã€`os.Args`ã§å—ã‘å–ã‚‹ã€‚

`os.Args`ã¯ string å‹ã®ã‚¹ãƒ©ã‚¤ã‚¹ã§ã€

- 0 ç•ªç›®ã®è¦ç´ ã«ã¯ã€å®Ÿè¡Œã—ãŸã‚³ãƒãƒ³ãƒ‰åãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã€‚
- 1 ç•ªç›®ä»¥é™ã®è¦ç´ ã«ã€ã‚³ãƒãƒ³ãƒ‰ã«æ¸¡ã•ã‚ŒãŸå¼•æ•°ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã€‚

```go:[ go run test.go 123 456 ]ã¨å®Ÿè¡Œã—ãŸ
func main() {
  fmt.Printf("args count: %d\n", len(os.Args))
  // â†’ 3
  fmt.Printf("args : %#v\n", os.Args)
  // â†’ []string{"/var/folders/rj/l6kf96gj15331qbmbr7lggp40000gn/T/go-build4014886209/b001/exe/test", "123", "456"}
  fmt.Printf("å®Ÿéš›ã«æ¬²ã—ã„å¼•æ•° : %#v\n", os.Args[1:])
  // â†’ []string{"123", "456"}
}
```

:::message

### æ¨™æº–å…¥åŠ›ã‹ã‚‰ã®å—ã‘å–ã‚Š

æ¨™æº–å…¥åŠ›ã¯`fmt.Scan()`ã§å—ã‘å–ã‚‹ã€‚

```go:å€‹æ•°ãŒå›ºå®šã§æ±ºã¾ã£ã¦ã„ã‚‹å ´åˆ
var a, b int
var s string
fmt.Scan(&a, &b, &s)
```

```go:nå€‹ã®å…¥åŠ›ã‚’å—ã‘å–ã‚‹å ´åˆ
nums := make([]int, n)
for _, num := range nums {
  fmt.Scan(&num)
}
```

https://zenn.dev/pikarich/articles/8f1c7fe4d04e93
:::

# flag ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸

ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ã®**ã‚ªãƒ—ã‚·ãƒ§ãƒ³**ï¼ˆãƒ•ãƒ©ã‚°ï¼‰ã‚’ä¾¿åˆ©ã«æ‰±ã†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã€‚

### å®šç¾©

ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’å®šç¾©ã™ã‚‹ã«ã¯ã€ä¸‹è¨˜ 2 ã¤ã®æ–¹æ³•ãŒã‚ã‚‹ã€‚

- `var å¤‰æ•° = flag.å‹å("ãƒ•ãƒ©ã‚°å", ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤, "èª¬æ˜æ–‡")` : `å‹å()`ã§ã¯ãƒã‚¤ãƒ³ã‚¿ãŒè¿”ã•ã‚Œã‚‹ã€‚
- `flag.å‹åVar(&å¤‰æ•°, "ãƒ•ãƒ©ã‚°å", ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤, "èª¬æ˜æ–‡")` : å¤‰æ•°ãŒæ—¢ã«å®£è¨€ã•ã‚Œã¦ã„ã‚‹å ´åˆã€‚`å‹åVar()`ã§ã¯å¤‰æ•°ã«ãƒã‚¤ãƒ³ãƒ‰ï¼ˆ=å®Ÿä½“ã‚’æ›´æ–°ï¼‰ã™ã‚‹ã€‚

### ãƒ‘ãƒ¼ã‚¹ï¼ˆè§£æï¼‰

ã“ã†ã—ã¦**ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’å®šç¾©ã—ãŸå¾Œ**ã€å®Ÿéš›ã«ãã‚Œã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹å‰ã«`flag.Parse()`ã§ã€ã‚³ãƒãƒ³ãƒ‰ã‚’ãƒ‘ãƒ¼ã‚¹ã—ãªã„ã¨ã„ã‘ãªã„ã€‚

### ä¾‹

`go run test.go -msg=ã“ã‚“ã«ã¡ã¯ -n=2`ã¨ã„ã†ã‚ˆã†ã«å®Ÿè¡Œã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã® msg ã‚ªãƒ—ã‚·ãƒ§ãƒ³ / n ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’å®Ÿè£…ã™ã‚‹ã«ã¯ã€ä¸‹è¨˜ã®ã‚ˆã†ã«æ›¸ãã€‚

```go
var msg = flag.String("msg", "ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã§ã™", "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ–‡")
var n int

func init() {
  flag.IntVar(&n, "n", 1, "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¹°ã‚Šè¿”ã™å›æ•°")
}
func main() {
  // ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ãƒ‘ãƒ¼ã‚¹ â†’ å®Ÿéš›ã«ãƒ•ãƒ©ã‚°å¤‰æ•°ã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚‹
  flag.Parse()
  fmt.Println(strings.Repeat(*msg, n)) // ã“ã‚“ã«ã¡ã¯ã“ã‚“ã«ã¡ã¯
}
```

:::message

### init()

init()ã¯ main()ã‚ˆã‚Šå…ˆã«å®Ÿè¡Œã•ã‚Œã‚‹ç‰¹æ®Šãªé–¢æ•°ã€‚
:::

# å…¥å‡ºåŠ›

| ç¨®é¡           | å¤‰æ•°      | èª¬æ˜                                                                                     |
| -------------- | --------- | ---------------------------------------------------------------------------------------- |
| æ¨™æº–å…¥åŠ›       | os.Stdin  | å…¥åŠ›ï¼ˆã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã¨ã‹ã‹ã‚‰å¾…ã¡å—ã‘ã‚‹ã‚„ã¤ï¼‰                                                 |
| æ¨™æº–å‡ºåŠ›       | os.Stdout | å‡ºåŠ›ã€‚æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã«ï¼ˆãƒ‘ã‚¤ãƒ—ã¨ã‹ã§ï¼‰æ¸¡ã™ã‚ˆã†ãªå€¤ã€‚ãªã®ã§ã‚¨ãƒ©ãƒ¼ã¯æ¨™æº–å‡ºåŠ›ã«å‡ºã•ãªã„ã“ã¨ã€‚ |
| æ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ› | os.Stderr | ã‚¨ãƒ©ãƒ¼ã‚’å‡ºåŠ›ã€‚                                                                           |

os.Stdin ã‚‰ã¯ã€**io.Reader**ã‚„**io.Writer**ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®Ÿè£…ã—ã¦ã„ã‚‹ã€‚
ãªã®ã§ã€æ§˜ã€…ãªé–¢æ•°ã‚„ãƒ¡ã‚½ãƒƒãƒ‰ã®å¼•æ•°ã¨ã—ã¦æ¸¡ã›ã‚‹ã€‚

:::message

### io.Readerã€io.Writer

ãã‚Œãã‚Œ 1 ã¤ã®ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆReadã€Writeï¼‰ã—ã‹æŒãŸãªã„ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã€‚
ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®æ›¸ãè¾¼ã¿ã€ãƒ¡ãƒ¢ãƒªã¸ã®æ›¸ãè¾¼ã¿...ãªã©ã€è‰²ã€…ãªã‚‚ã®ã¸ã®èª­ã¿æ›¸ãã‚’æŠ½è±¡åŒ–ã—ã¦ã„ã‚‹ã€‚
:::

# ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®çµ‚äº†

`os.Exit(0)`ã§ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’çµ‚äº†ã™ã‚‹ã€‚_å‘¼ã³å‡ºã—å…ƒã«ã‚‚çµ‚äº†çŠ¶æ…‹ãŒä¼ãˆã‚‰ã‚Œã‚‹_ã€‚

- 0 : æ­£å¸¸
- 0 ä»¥å¤– : ç•°å¸¸

# ãƒ•ã‚¡ã‚¤ãƒ«

- ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã : `f, err := os.Open("ãƒ•ã‚¡ã‚¤ãƒ«å")`
- ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ : `f, err := os.Create("ãƒ•ã‚¡ã‚¤ãƒ«å")`
- è©³ç´°ãªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã—ã¦ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã :
  `f, err := os.OpenFile(ãƒ•ã‚¡ã‚¤ãƒ«å, ãƒ•ãƒ©ã‚°(ãƒ•ã‚¡ã‚¤ãƒ«ãŒç„¡ã‘ã‚Œã°ä½œæˆã™ã‚‹ç­‰), ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³)`

- ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€ : `[*os.Fileå‹].Read(èª­ã¿è¾¼ã‚“ã ãƒ‡ãƒ¼ã‚¿ã‚’æ ¼ç´ã™ã‚‹ã‚¹ãƒ©ã‚¤ã‚¹)`
- ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€ : `[*os.Fileå‹].Write(æ›¸ãè¾¼ã‚€æ–‡å­—åˆ—ã‚’æ ¼ç´ã—ãŸã‚¹ãƒ©ã‚¤ã‚¹)`

```go:èª­ã¿è¾¼ã¿
func main() {
  // ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã
  f, err := os.Open("./ingo.log")

  // é–¢æ•°ã®å®Ÿè¡Œçµ‚äº†æ™‚ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‰ã˜ã‚‹ã®ã‚’äºˆç´„ã—ã¦ãŠã
  defer f.Close()

  // ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ãŒæ ¼ç´ã•ã‚Œã‚‹ã€ç©ºã®ã‚¹ãƒ©ã‚¤ã‚¹ã‚’ä½œæˆ
  data := make([]byte, 1024) // æœ€å¤§1024byte

  // ï¼ˆç©ºã®ã‚¹ãƒ©ã‚¤ã‚¹ã«ï¼‰ãƒ•ã‚¡ã‚¤ãƒ«fã®ä¸­èº«ã‚’æ ¼ç´
  count, err := f.Read(data)
  fmt.Println(count) // ä½•byteèª­ã¿è¾¼ã‚“ã ã‹

  // èª­ã¿è¾¼ã¿ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
  if err != nil {
    fmt.Println("èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼", err)
  }

  // ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ã‚’å‡ºåŠ› (stringã§ã‚­ãƒ£ã‚¹ãƒˆã—ãªã„ã¨ã€æ–‡å­—åˆ—ã«ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã™ã‚‹å‰ã®ãƒã‚¤ãƒˆåˆ—ãŒå‡ºåŠ›ã•ã‚Œã¦ã—ã¾ã†)
  fmt.Println(string(data))
}
```

```go:ä½œæˆ+æ›¸ãè¾¼ã¿
func main() {
  text := "æ›¸ãè¾¼ã¿ãŸã„ãƒ†ã‚­ã‚¹ãƒˆ"
  data := []byte(text)

  // ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
  f, err := os.Create("create_sample.txt")
  if err != nil {
    fmt.Println("ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆæ™‚ã‚¨ãƒ©ãƒ¼")
  }
  defer f.Close()

  // ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã¿
  count, err := f.Write(data)
  if err != nil {
    fmt.Println("ãƒ•ã‚¡ã‚¤ãƒ«æ›¸ãè¾¼ã¿æ™‚ã‚¨ãƒ©ãƒ¼")
  }
  fmt.Println(count) // // ä½•byteèª­ã¿è¾¼ã‚“ã ã‹
}
```

```txt:create_sample.txt
æ›¸ãè¾¼ã¿ãŸã„ãƒ†ã‚­ã‚¹ãƒˆ
```

# ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹

`path/filepath`ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã†ã€‚

```go
path := filepath.Join("dir", "main.go")
fmt.Println(path) // dir/main.go
// æ‹¡å¼µå­ ã®ã¿
fmt.Println(filepath.Ext(path)) // .go
// ãƒ•ã‚¡ã‚¤ãƒ«å ã®ã¿
fmt.Println(filepath.Base(path)) // main.go
// ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª ã®ã¿
fmt.Println(filepath.Dir(path)) // dir
```

# ãƒ­ã‚°

```go:log.Fatal, log.SetPrefix
func main() {
	log.Print("Printãƒ­ã‚°1")

	log.SetPrefix("main(): ")
	log.Print("Printãƒ­ã‚°2")

	log.Fatal("æœ€çµ‚ãƒ­ã‚°")
	log.Print("Printãƒ­ã‚°3 log.Fatalã§çµ‚äº†ã•ã›ã‚‹ãŸã‚ã“ã‚Œã¯å®Ÿè¡Œã•ã‚Œãªã„")
	/*
		2023/08/24 06:48:09 Printãƒ­ã‚°1
		main(): 2023/08/24 06:48:09 Printãƒ­ã‚°2
		main(): 2023/08/24 06:48:09 æœ€çµ‚ãƒ­ã‚°
		exit status 1
	*/
}
```

```go:log.Panic
func main() {
  log.Print("printã‚ã")
  // â†’ 2021/08/09 07:23:53 printã‚ã

  log.Panic("panicã‚ã")
  fmt.Print("ã“ã‚Œã¯è¦‹ãˆãªã„")
  // â†’ panic: panicã‚ã
  //   goroutine 1 [running]:
  //   log.Panic(0xc0000c3f58, 0x1, 0x1)
  //       /usr/local/go/src/log/log.go:354 +0xae
  //   main.main()
  //       /Users/itotakuya/projects/go/src/helloworld/main.go:814 +0xa5
  // Panic()ä»¥é™ã¯å®Ÿè¡Œã•ã‚Œãªã„
}
```

### ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ­ã‚°ã‚’è¨˜éŒ²ã™ã‚‹

```go:main.go
func main() {
  // ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
  file, err := os.OpenFile("ingo.log", os.O_CREATE|os.O_APPEND|os.O_WRONLY, 0644)

  if err != nil {
  log.Fatal("ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ")
  }

  // å¾Œã§ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ­ã‚°ã‚’è¨˜éŒ²ã™ã‚‹ãŒã€file.Close()ã‚’å¿˜ã‚Œãªã„ã‚ˆã†ã«deferäºˆç´„
  defer file.Close()

  // é€šå¸¸é€šã‚Šã€æ¨™æº–å‡ºåŠ›ã¸
  log.Print("ãƒ­ã‚°1")

  // fileã«ãƒ­ã‚°ã‚’è¨˜éŒ²ã™ã‚‹ã“ã¨ã‚’å®£è¨€
  // ã“ã‚Œä»¥é™ã€logå‡ºåŠ›ã™ã‚‹ã¨ã€ãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜éŒ²ã•ã‚Œã‚‹
  log.SetOutput(file)

  // ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã¾ã‚Œã‚‹
  log.Print("ãƒ­ã‚°2")
}
```

# Print é–¢æ•°

```go
func main() {
  fmt.Print("Hello", "world!")
  fmt.Print("Hello", "world!")
  // -> Helloworld!Helloworld!

  // Printlnã®å ´åˆã¯ã€ã‚¹ãƒšãƒ¼ã‚¹ã¨æ”¹è¡ŒãŒæŒ¿å…¥ã•ã‚Œã‚‹
  fmt.Println("Hello", "world!")
  fmt.Println("Hello", "world!")
  // -> Hello world!
  //    Hello world!

  hello := "Hello world!"
  // Printf : ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’æŒ‡å®šã—ã¦å‡ºåŠ›ã™ã‚‹
  fmt.Printf("%s\n", hello) // %s : æ–‡å­—ã®ã¿ã‚’å‡ºåŠ› (""ãªã—)
  fmt.Printf("%#v\n", hello) // %#v : Goã®æ–‡æ³•ã§ã®è¡¨ç¾ã‚’å‡ºåŠ›
  // -> Hello world!
  //    "Hello world!"
}
```

## ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæŒ‡å®šå­

`%v`ã«ã¯ä½•ã§ã‚‚æ¸¡ã—ã¦okã€‚

æ§‹é€ ä½“ã®å‡ºåŠ›ã«ã¯ã€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæŒ‡å®šå­ã¯`%+v`ã‹`%#v`ãŒã„ã„ã€‚
```go
t := &T{ 7, -2.35, "abc\tdef" }

fmt.Printf("%+v\n", t)
// &{a:7 b:-2.35 c:abc     def}

fmt.Printf("%#v\n", t)
&main.T{a:7, b:-2.35, c:"abc\tdef"}
```

:::message
Printf ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæŒ‡å®šæ–¹æ³•ã«ã¤ã„ã¦ã¯ã€ä¸‹ã®è¨˜äº‹ãŒè©³ç´°ã«æ›¸ã„ã¦ã‚ã‚‹ã€‚
:::
https://qiita.com/rock619/items/14eb2b32f189514b5c3c
