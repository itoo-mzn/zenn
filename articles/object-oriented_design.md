---
title: "ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘è¨­è¨ˆå®Ÿè·µã‚¬ã‚¤ãƒ‰"
emoji: "ğŸ“˜"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘", "è¨­è¨ˆ"]
published: false
---
# æ›¸ç±
https://gihyo.jp/book/2016/978-4-7741-8361-9

# Gitãƒ¬ãƒã‚¸ãƒˆãƒª
æ›¸ã„ãŸã‚³ãƒ¼ãƒ‰ã¯Gitãƒ¬ãƒã‚¸ãƒˆãƒªã«ä¿å­˜ã€‚
https://github.com/ito0804takuya/object-oriented_design

# 1ç« ã€€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘è¨­è¨ˆ

## è¨­è¨ˆ
å¾Œã®å¤‰æ›´ã‚’å®¹æ˜“ã«ã™ã‚‹è¡Œã„ã€‚
ã‚³ãƒ¼ãƒ‰ã®æ§‹æˆã“ããŒè¨­è¨ˆã€‚è¨­è¨ˆ(ã‚³ãƒ¼ãƒ‰ã®æ§‹æˆ)ã¯èŠ¸è¡“ã§ã‚ã‚‹ã€‚
å¤‰æ›´ãŒå®¹æ˜“ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€ä½œã‚‹ã®ã‚‚æ‹¡å¼µã™ã‚‹ã®ã‚‚æ¥½ã—ã„ã€‚

## ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘è¨­è¨ˆ
ä¾å­˜é–¢ä¿‚ã‚’ç®¡ç†ã™ã‚‹ã“ã¨ã€‚
##### ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
éƒ¨å“ã€‚
##### ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆé–“ã§å—ã‘æ¸¡ã•ã‚Œã‚‹ã‚‚ã®ã€‚ç›¸äº’ä½œç”¨ã€‚

## ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘è¨­è¨ˆã®é“å…·
è¨­è¨ˆã™ã‚‹éš›ã«è¨­è¨ˆè€…ã‚’åŠ©ã‘ã‚‹é“å…·ã¨ã—ã¦ã€**åŸå‰‡**ã¨**ãƒ‘ã‚¿ãƒ¼ãƒ³**ãŒã‚ã‚‹ã€‚
### è¨­è¨ˆåŸå‰‡
#### SOLID
1. Single Responsibility Principleï¼š**å˜ä¸€è²¬ä»»ã®åŸå‰‡**
2. Open/closed principleï¼š**ã‚ªãƒ¼ãƒ—ãƒ³/ã‚¯ãƒ­ãƒ¼ã‚¹ãƒ‰ã®åŸå‰‡**
3. Liskov substitution principleï¼š**ãƒªã‚¹ã‚³ãƒ•ã®ç½®æ›åŸå‰‡**
4. Interface segregation principleï¼š**ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹åˆ†é›¢ã®åŸå‰‡**
5. Dependency inversion principleï¼š**ä¾å­˜æ€§é€†è»¢ã®åŸå‰‡**
:::message
æœ¬æ›¸ã®ãƒ¡ã‚¤ãƒ³ã€‚
:::
### ãƒ‡ã‚¶ã‚¤ãƒ³(è¨­è¨ˆ)ãƒ‘ã‚¿ãƒ¼ãƒ³
ã„ã‚ã‚†ã‚‹**GoF**
:::message alert
æœ¬æ›¸ã§ã¯ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯è§£èª¬ã—ã¦ã„ãªã„ã€‚
:::

# 2ç« ã€€å˜ä¸€è²¬ä»»ã®ã‚¯ãƒ©ã‚¹ã‚’è¨­è¨ˆã™ã‚‹
**ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘è¨­è¨ˆã®ã‚·ã‚¹ãƒ†ãƒ ã®åŸºç¤ã¯ï¼ˆã‚¯ãƒ©ã‚¹ã§ãªãï¼‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**ã§ã‚ã‚‹ã€‚
(ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã“ããŒè¨­è¨ˆã®æ ¸ã ãŒã€ã‚¯ãƒ©ã‚¹ã®ã»ã†ãŒåˆ†ã‹ã‚Šã‚„ã™ã„ã®ã§ã€ã‚¯ãƒ©ã‚¹ã‹ã‚‰è§£èª¬ã—ã¦ã„ã‚‹ã€‚)

## å¤‰æ›´ãŒå®¹æ˜“ãªã‚³ãƒ¼ãƒ‰ã«æ±‚ã‚ã‚‰ã‚Œã‚‹æ€§è³ª (TRUE)
#### è¦‹é€šã—ãŒè‰¯ã„(Transparent)
  å¤‰æ›´ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚‚ã€ãã®ã‚³ãƒ¼ãƒ‰ã«ä¾å­˜ã™ã‚‹åˆ¥ã®å ´æ‰€ã®ã‚³ãƒ¼ãƒ‰ã«ãŠã„ã¦ã‚‚ã€**å¤‰æ›´ã«ã‚ˆã‚‹å½±éŸ¿ãŒæ˜ç™½**ã§ã‚ã‚‹ã“ã¨ã€‚ï¼ˆå½±éŸ¿ç¯„å›²ãŒã‚ã‹ã‚‹ã‹ï¼‰
#### åˆç†çš„(Reasonable)
  ã©ã‚“ãªå¤‰æ›´ã§ã‚ã£ã¦ã‚‚ã€**ã‹ã‹ã‚‹ã‚³ã‚¹ãƒˆã¯å¤‰æ›´ãŒã‚‚ãŸã‚‰ã™åˆ©ç›Šã«ãµã•ã‚ã—ã„**ã€‚ï¼ˆä½ã‚³ã‚¹ãƒˆã‹ï¼‰
#### åˆ©ç”¨æ€§ãŒé«˜ã„(Usable)
  æ–°ã—ã„ç’°å¢ƒã€**äºˆæœŸã—ã¦ã„ãªã‹ã£ãŸç’°å¢ƒ**ã§ã‚‚å†åˆ©ç”¨ã§ãã‚‹ã€‚ï¼ˆã©ã“ã§ã‚‚å‹•ãã‹ï¼‰
#### æ¨¡ç¯„çš„(Examplary)
  å¾Œã‹ã‚‰ã‚³ãƒ¼ãƒ‰ã«å¤‰æ›´ã‚’åŠ ãˆã‚‹äººãŒã€ä¸Šè¨˜ã®**å“è³ªã‚’è‡ªç„¶ã¨ä¿ã¤ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰**ã§ã‚ã‚‹ã€‚ï¼ˆä»–äººã‚’å°ãã“ã¨ãŒã§ãã‚‹ã‹ï¼‰

## ãªãœå˜ä¸€è²¬ä»»ãŒé‡è¦ãªã®ã‹
1. è²¬ä»»ãŒäº’ã„ã«çµåˆã—ã™ãã¦ã€å¿…è¦ãªæŒ¯ã‚‹èˆã„ã ã‘ã‚’å–ã‚Šå‡ºã™ã“ã¨ï¼ˆå†åˆ©ç”¨ï¼‰ãŒã§ããªã„ãŸã‚ã€‚
2. å¤‰æ›´ã‚’åŠ ãˆã‚‹ãŸã³ã«ã€ãã®ã‚¯ãƒ©ã‚¹ã«ä¾å­˜ã™ã‚‹ã‚¯ãƒ©ã‚¹ã™ã¹ã¦ã‚’ç ´å£Šã™ã‚‹å±é™ºæ€§ãŒã‚ã‚‹ãŸã‚ã€‚

## ã‚¯ãƒ©ã‚¹ãŒå˜ä¸€è²¬ä»»ã‹ã©ã†ã‹ã‚’è¦‹æ¥µã‚ã‚‹
1. **ã‚¯ãƒ©ã‚¹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è³ªå•ã«è¨€ã„æ›ãˆã‚‹ã€‚**
  - ã€ŒGearã•ã‚“ã€ã“ã®è‡ªè»¢è»Šã®ã‚®ã‚¢ã®æ¯”ç‡ã‚’æ•™ãˆã¦ãã‚Œã¾ã™ã‹ï¼Ÿã€â†’OK
  - ã€ŒGearã•ã‚“ã€ã“ã®è‡ªè»¢è»Šã®ã‚¿ã‚¤ãƒ¤ã®ã‚µã‚¤ã‚ºã‚’æ•™ãˆã¦ãã‚Œã¾ã™ã‹ï¼Ÿã€â†’NG
2. **ã‚¯ãƒ©ã‚¹ã®è²¬ä»»ã‚’1æ–‡ã§è¨€ã„è¡¨ã™**
  - ã€Œè‡ªè»¢è»Šã¸ã®ã‚®ã‚¢ã®å½±éŸ¿ã‚’è¨ˆç®—ã™ã‚‹ã€â†’OK
  - ã€Œè‡ªè»¢è»Šã¸ã®ã‚®ã‚¢ã®å½±éŸ¿ã¨ã€ã‚¿ã‚¤ãƒ¤ã®å††å‘¨ã‚’è¨ˆç®—ã™ã‚‹ã€â†’NG

## å¤‰æ›´ã‚’æ­“è¿ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã
å®Ÿéš›ã«å¤‰æ›´ãŒèµ·ã“ã‚‹ã‹orã©ã‚“ãªå¤‰æ›´ãŒãŠã“ã‚‹ã‹ã¯åˆ†ã‹ã‚‰ãªã„ãŒã€å®¹æ˜“ã«å¤‰æ›´ã‚’å—ã‘å…¥ã‚Œã‚‰ã‚Œã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã“ã¨ã¯ã€å°†æ¥çš„ã«å¤§ããªè¦‹è¿”ã‚Šã¨ãªã‚‹ã€‚
ä»¥ä¸‹ã¯ã€ãã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã€‚

### ãƒ‡ãƒ¼ã‚¿ã§ãªãã€æŒ¯ã‚‹èˆã„ã«ä¾å­˜ã™ã‚‹
ãƒ‡ãƒ¼ã‚¿ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã¯2ã¤ã®ã©ã¡ã‚‰ã‹ã®æ–¹æ³•ã§è¡Œã‚ã‚Œã‚‹ãŒã€2.ã‚’ä½¿ã†ã‚ˆã†ã«ã™ã‚‹ã€‚
1. ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å¤‰æ•°ã‚’ç›´æ¥å‚ç…§ã™ã‚‹
2. **ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å¤‰æ•°ã‚’ã‚¢ã‚¯ã‚»ã‚µãƒ¡ã‚½ãƒƒãƒ‰ã§åŒ…ã¿éš ã™**ï¼ˆã‚²ãƒƒã‚¿ã‚’çµŒç”±ã•ã›ã‚‹ï¼‰

#### ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å¤‰æ•°ã®éš è”½ (2.)
```ruby
class Gear
  # ã‚²ãƒƒã‚¿ã‚’ç”¨æ„ â†’ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å¤‰æ•°ã®éš è”½
  attr_reader :chainring, :cog

  def initialize(chainring, cog)
    @chainring = chainring # ãƒã‚§ãƒ¼ãƒ³ãƒªãƒ³ã‚°ã®æ­¯æ•°
    @cog = cog # ã‚³ã‚°ã®æ­¯æ•°
  end

  # (ä»¥ä¸‹ç•¥)
end
```
`attr_reader`ã‚„`attr_accessor`ã‚’ä½¿ã‚ãªã„ï¼ˆã‚²ãƒƒã‚¿ã‚’ç”¨æ„ã—ãªã„ï¼‰å ´åˆã€ä¾‹ãˆã°@cogã‚’ä¿®æ­£ã™ã‚‹å¿…è¦ãŒç”Ÿã˜ãŸã¨ãã€@cogã®å‡ºç¾ç®‡æ‰€ã™ã¹ã¦ã‚’ä¿®æ­£ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚
ãã‚Œã«å¯¾ã—ã€`attr_reader`ã¯è£ã§ä¸‹è¨˜ã®å®Ÿè£…ã‚’ã—ã¦ãã‚Œã¦ã„ã‚‹ãŸã‚ã€1ç®‡æ‰€ã ã‘ã®ä¿®æ­£ã§å¤‰åŒ–ã«å¯¾å¿œã§ãã‚‹ã€‚
:::message
ã‚²ãƒƒã‚¿ã‚’è¨­ã‘ã‚‹ã“ã¨ã§ã€(ã©ã“ã‹ã‚‰ã§ã‚‚å‚ç…§ã•ã‚Œã‚‹)**ãƒ‡ãƒ¼ã‚¿** â†’ (1ç®‡æ‰€ã§å®šç¾©ã•ã‚Œã‚‹)**æŒ¯ã‚‹èˆã„**ã«å¤‰ã‚ã‚‹ã€‚
:::
```ruby
def cog
  @cog # ã“ã“ã‚’ä¿®æ­£ã™ã‚Œã°ã„ã„
end
```
ã¤ã¾ã‚Šã€**@cogã¨ã„ã†ãƒ‡ãƒ¼ã‚¿ã§ãªãã€cogã¨ã„ã†æŒ¯ã‚‹èˆã„(ã‚¢ã‚¯ã‚»ã‚µãƒ¡ã‚½ãƒƒãƒ‰)ã«ä¾å­˜ã™ã‚‹**ã‚ˆã†ã«ã™ã‚‹ã€‚

## ã‚ã‚‰ã‚†ã‚‹ç®‡æ‰€ã‚’å˜ä¸€è²¬ä»»ã«ã™ã‚‹

### ãƒ¡ã‚½ãƒƒãƒ‰ã‹ã‚‰ä½™è¨ˆãªè²¬ä»»ã‚’æŠ½å‡ºã™ã‚‹
ï¼ˆã‚¯ãƒ©ã‚¹ã¨åŒæ§˜ã®ç†ç”±ã§ï¼‰ãƒ¡ã‚½ãƒƒãƒ‰ã‚‚å˜ä¸€è²¬ä»»ã§ã‚ã‚‹ã¹ãã€‚
ãƒ¡ã‚½ãƒƒãƒ‰ã«å¯¾ã—ã¦ã‚‚ã€ãã®å½¹å‰²ã‚’1æ–‡ã§èª¬æ˜ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã€‚

2ã¤ã®è²¬ä»»ã‚’æŒã£ã¦ã„ã‚‹ã€‚ï¼ˆç›´å¾„ã®è¨ˆç®— + ç¹°ã‚Šè¿”ã—å‡¦ç†ï¼‰
```ruby
# è¤‡æ•°ã®ã‚¿ã‚¤ãƒ¤ã®ç›´å¾„ã‚’ãã‚Œãã‚Œè¨ˆç®—
def diameters
  wheels.collect { |wheel|
    wheel.rim + (wheel.tire * 2) # ç›´å¾„ = ãƒªãƒ +ã‚¿ã‚¤ãƒ¤ã®åšã¿
  }
end
```

ãƒ¡ã‚½ãƒƒãƒ‰ã«ã¯å˜ä¸€ã®è²¬ä»»ã‚’æŒãŸã›ã‚‹ã€‚ï¼ˆç›´å¾„ã®è¨ˆç®— , ç¹°ã‚Šè¿”ã—å‡¦ç†ï¼‰
```ruby
# è¤‡æ•°ã®ã‚¿ã‚¤ãƒ¤ã®ç›´å¾„ã‚’å–å¾—
def diameters
  wheels.collect { |wheel| diameter(wheel) }
end

# ã‚¿ã‚¤ãƒ¤ã®ç›´å¾„ã‚’è¨ˆç®—
def diameter(wheel)
  wheel.rim + (wheel.tire * 2) # ç›´å¾„ = ãƒªãƒ +ã‚¿ã‚¤ãƒ¤ã®åšã¿
end
```

# 3ç«  ä¾å­˜é–¢ä¿‚ã‚’ç®¡ç†ã™ã‚‹
é©åˆ‡ã«è¨­è¨ˆã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯å˜ä¸€ã®è²¬ä»»ã‚’æŒã¤ã€‚ãã®ãŸã‚ã€ç›®çš„ã®ãŸã‚ã«ã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒå£«ã®å…±åŒä½œæ¥­ãŒå¿…è¦ã§ã‚ã‚Šã€å…±åŒä½œæ¥­ã‚’ã™ã‚‹ã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ä»–ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’çŸ¥ã£ã¦ã„ãªã„ã¨ã„ã‘ãªã„ã€‚**ã€ŒçŸ¥ã£ã¦ã„ã‚‹ã€ã¨ã„ã†ã®ã¯ä¾å­˜**ã§ã‚ã‚Šã€ã—ã£ã‹ã‚Šç®¡ç†ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚

## ä¾å­˜é–¢ä¿‚ã¨ã¯
ã‚¯ãƒ©ã‚¹é–“ã«ä¸€å®šã®ä¾å­˜é–¢ä¿‚ãŒç”Ÿã¾ã‚Œã‚‹ã®ã¯é¿ã‘ã‚‰ã‚Œãªã„ãŒã€ä¾å­˜ã¯æœ€ä½é™ã«ã™ã‚‹ã¹ãã€‚ï¼ˆã‚³ãƒ¼ãƒ‰ã®åˆç†æ€§ãŒå¤±ã‚ã‚Œã‚‹ãŸã‚ï¼‰

ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã«ã¯ã€ä¾å­˜é–¢ä¿‚ãŒã‚ã‚‹ã€‚ï¼ˆWheelã®å¤‰æ›´ã«ã‚ˆã£ã¦ã€Gearã®å¤‰æ›´ãŒå¼·åˆ¶ã•ã‚Œã‚‹çŠ¶æ³ã€‚ï¼‰
```ruby
# è‡ªè»¢è»Šã®ã‚®ã‚¢
class Gear
  attr_reader :chainring, :cog, :rim, :tire

  def initialize(chainring, cog, rim, tire)
    @chainring = chainring # ãƒã‚§ãƒ¼ãƒ³ãƒªãƒ³ã‚°ã®æ­¯æ•°
    @cog = cog # ã‚³ã‚°ã®æ­¯æ•°
    @rim = rim # ãƒªãƒ (ã‚¿ã‚¤ãƒ¤ã®å†…å´ã®é‡‘å±éƒ¨åˆ†)ã®ç›´å¾„
    @tire = tire # ã‚¿ã‚¤ãƒ¤ã®åšã¿
  end

  # ã‚®ã‚¢ã®æ¯”ç‡(= ãƒšãƒ€ãƒ«1å›è»¢ã«å¯¾ã™ã‚‹è»Šè¼ªã®å›è»¢æ•°)
  def ratio
    chainring / cog.to_f # æµ®å‹•å°æ•°ç‚¹ã¸å¤‰æ›
  end

  # ã‚®ã‚¢ã‚¤ãƒ³ãƒ(ã‚®ã‚¢ã¨è»Šè¼ªã®å¤§ãã•ãŒç•°ãªã£ã¦ã‚‚æ¯”è¼ƒã§ãã‚‹åŸºæº–)
  def gear_inches
    # ã‚®ã‚¢æ¯”ç‡ * ã‚¿ã‚¤ãƒ¤ã®ç›´å¾„
    ratio * Wheel.new(rim, tire).diameter
  end
end

# è‡ªè»¢è»Šã®è»Šè¼ª
class Wheel
  attr_reader :rim, :tire

  def initialize(rim, tire)
    @rim = rim # ãƒªãƒ (ã‚¿ã‚¤ãƒ¤ã®å†…å´ã®é‡‘å±éƒ¨åˆ†)ã®ç›´å¾„
    @tire = tire # ã‚¿ã‚¤ãƒ¤ã®åšã¿
  end

  # ã‚¿ã‚¤ãƒ¤ã®ç›´å¾„
  def diameter
    rim + (tire * 2) # ç›´å¾„ = ãƒªãƒ +ã‚¿ã‚¤ãƒ¤ã®åšã¿
  end
end

puts Gear.new(52, 11, 26, 1.5).gear_inches
```

### ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒæ¬¡ã®ã“ã¨ã‚’çŸ¥ã£ã¦ã„ã‚‹ã¨ãã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã¯ä¾å­˜é–¢ä¿‚ãŒã‚ã‚‹ã€‚
- **ä»–ã®ã‚¯ãƒ©ã‚¹ã®åå‰**
  Gearã¯ã€Wheelã¨ã„ã†åå‰ã®ã‚¯ãƒ©ã‚¹ãŒå­˜åœ¨ã™ã‚‹ã“ã¨ã‚’çŸ¥ã£ã¦ã„ã‚‹ã€‚
- **selfä»¥å¤–ã®ã©ã“ã‹ã«é€ã‚ã†ã¨ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®åå‰**
  Gearã¯ã€Wheelã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒdiameterã«å¿œç­”ã™ã‚‹ã“ã¨ã‚’çŸ¥ã£ã¦ã„ã‚‹ã€‚
- **ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¦æ±‚ã™ã‚‹å¼•æ•°**
  Gearã¯ã€Wheel.newã«rimã¨tireãŒå¿…è¦ãªã“ã¨ã‚’çŸ¥ã£ã¦ã„ã‚‹ã€‚
- **å¼•æ•°ã®é †ç•ª**
  Gearã¯ã€Wheel.newã®ç¬¬1å¼•æ•°ãŒrimã§ã€ç¬¬2å¼•æ•°ãŒtireã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹ã“ã¨ã‚’çŸ¥ã£ã¦ã„ã‚‹ã€‚

## ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆé–“ã®çµåˆ
2ã¤ä»¥ä¸Šã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®çµåˆãŒå¼·å›ºãªã¨ãã€ãã‚Œã‚‰ã¯1ã¤ã®ãƒ¦ãƒ‹ãƒƒãƒˆã§ã‚ã‚‹ã‚ˆã†ã«æŒ¯ã‚‹èˆã†ã€‚
ã¤ã¾ã‚Šã€1ã¤ã ã‘ã‚’å†åˆ©ç”¨ã™ã‚‹ ã¨ã„ã†ã“ã¨ãŒã§ããªã„ã€‚

## ç–çµåˆãªã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã
### ä¾å­˜ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æ³¨å…¥
```diff ruby
# è‡ªè»¢è»Šã®ã‚®ã‚¢
class Gear
- attr_reader :chainring, :cog, :rim, :tire
+ attr_reader :chainring, :cog, :wheel

  def initialize(chainring, cog, rim, tire)
    @chainring = chainring # ãƒã‚§ãƒ¼ãƒ³ãƒªãƒ³ã‚°ã®æ­¯æ•°
    @cog = cog # ã‚³ã‚°ã®æ­¯æ•°
-   @rim = rim # ãƒªãƒ (ã‚¿ã‚¤ãƒ¤ã®å†…å´ã®é‡‘å±éƒ¨åˆ†)ã®ç›´å¾„
-   @tire = tire # ã‚¿ã‚¤ãƒ¤ã®åšã¿
+   @wheel = wheel # wheelã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
  end

  # ã‚®ã‚¢ã®æ¯”ç‡(= ãƒšãƒ€ãƒ«1å›è»¢ã«å¯¾ã™ã‚‹è»Šè¼ªã®å›è»¢æ•°)
  def ratio
    chainring / cog.to_f # æµ®å‹•å°æ•°ç‚¹ã¸å¤‰æ›
  end

  # ã‚®ã‚¢ã‚¤ãƒ³ãƒ(ã‚®ã‚¢ã¨è»Šè¼ªã®å¤§ãã•ãŒç•°ãªã£ã¦ã‚‚æ¯”è¼ƒã§ãã‚‹åŸºæº–)
  def gear_inches
    # ã‚®ã‚¢æ¯”ç‡ * ã‚¿ã‚¤ãƒ¤ã®ç›´å¾„
-   ratio * Wheel.new(rim, tire).diameter
+   ratio * wheel.diameter
  end
end

- puts Gear.new(52, 11, 26, 1.5).gear_inches
+ puts Gear.new(52, 11, Wheel.new(26, 1.5)).gear_inches # GearãŒä¾å­˜ã—ã¦ã„ã‚‹Wheelã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ³¨å…¥
```
ä¾å­˜ãŒå‰Šæ¸›ã•ã‚Œã€ä»Šã¯**wheelãŒdiameterãƒ¡ã‚½ãƒƒãƒ‰ã«å¿œç­”ã™ã‚‹ã“ã¨ã ã‘çŸ¥ã£ã¦ã„ã‚‹(1ã¤ã ã‘ä¾å­˜ã‚’æ®‹ã—ã¦ã„ã‚‹)çŠ¶æ³**ã«æ”¹å–„ã€‚

### å¤–éƒ¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’éš”é›¢ã™ã‚‹
gear_inchesã®`wheel.diameter`ã¯ã€Gearã«ãŠã„ã¦ã¯**å¤–éƒ¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**ã€‚
```ruby
def gear_inches
  # ã‚®ã‚¢æ¯”ç‡ * ã‚¿ã‚¤ãƒ¤ã®ç›´å¾„
  ratio * wheel.diameter # selfã¸ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸+å¤–éƒ¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ (å¤–éƒ¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå«ã¾ã‚Œã¦ã„ã‚‹)
end
```
ä»Šã¯ç°¡ç´ ãªã‚³ãƒ¼ãƒ‰ã ã‹ã‚‰è‰¯ã„ãŒã€gear_inchesãŒè¤‡é›‘ã«ãªã‚‹ã»ã©ã“ã®å¤–éƒ¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ã‚ˆã£ã¦å¤‰æ›´ãŒå¿…è¦ã«ãªã‚‹å¯èƒ½æ€§(å£Šã‚Œã‚‹å±é™ºæ€§)ãŒé«˜ããªã‚‹ã€‚
ãã“ã§ã€gear_incheså†…ã®**å¤–éƒ¨çš„ãªä¾å­˜ã‚’å–ã‚Šé™¤ããŸã‚ã€å°‚ç”¨ã®ãƒ¡ã‚½ãƒƒãƒ‰å†…ã«ã‚«ãƒ—ã‚»ãƒ«åŒ–ã™ã‚‹**ã€‚
```ruby
def gear_inches
  ratio * diameter # selfã¸ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿
end

def diameter
  wheel.diameter # å¤–éƒ¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
end
```

### å¼•æ•°ã®é †ç•ªã¸ã®ä¾å­˜ã‚’é™¤å»ã™ã‚‹
å¼•æ•°ãŒå¿…è¦ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚‹ã¨ãã€å¼•æ•°ã‚’ã€Œæ­£ã—ã„é †ç•ªã€ã§æ¸¡ã™å¿…è¦ãŒã‚ã‚‹å ´åˆã€ãã‚Œã¯**å¼•æ•°ã®é †ç•ªã«ä¾å­˜ã—ã¦ã„ã‚‹**ã€‚
```ruby:å¼•æ•°ã®é †ç•ªã«ä¾å­˜ã—ã¦ã„ã‚‹
# ç¬¬1å¼•æ•°ã¯chainringã§, ç¬¬2å¼•æ•°ã¯cog, ç¬¬3å¼•æ•°ã¯wheel ã§ã‚ã‚‹ã“ã¨ã‚’çŸ¥ã£ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚‹
Gear.new(52, 11, Wheel.new(26, 1.5))
```

:::message alert
æœ¬æ›¸ã§ã¯ã€Œå¼•æ•°ã‚’ãƒãƒƒã‚·ãƒ¥ã§æ¸¡ã™ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã€ãŒç´¹ä»‹ã•ã‚Œã¦ã„ãŸãŒã€ä»Šã¯**ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°**ãŒã‚ã‚‹ã®ã§ã€ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°ã‚’ä½¿ã†ã»ã†ãŒã„ã„ã€‚
ï¼ˆèª¿ã¹ãŸã¨ã“ã‚ã€æœ¬æ›¸ãŒ2016å¹´å‡ºç‰ˆã§ã€ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°ã¯2017å¹´ã«å°å…¥ã•ã‚ŒãŸã®ã§ã€ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãŒæ‚ªã‹ã£ãŸã®ã ã¨æ€ã‚ã‚Œã‚‹ã€‚ï¼‰
:::

```ruby:ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°
Gear.new(chainring: 52, cog: 11, wheel: Wheel.new(26, 1.5))
```

## ä¾å­˜æ–¹å‘ã®ç®¡ç†
ä¾å­˜é–¢ä¿‚ã«ã¯å¸¸ã«æ–¹å‘ãŒã‚ã‚‹ã€‚ä¾å­˜æ–¹å‘ã®æ±ºã‚æ–¹ã‚’çŸ¥ã‚‹ã€‚

### ä¾å­˜æ–¹å‘ã®é¸æŠ
:::message
çµè«– : **ã€Œè‡ªèº«ã‚ˆã‚Šã‚‚å¤‰æ›´ã•ã‚Œãªã„ã‚‚ã®ã€ã«ä¾å­˜ã™ã‚‹ã“ã¨**
:::
#### è¦‹å®šã‚æ–¹ãƒ»è€ƒãˆæ–¹
- ãã®ã‚¯ãƒ©ã‚¹ã¯ä»–ã®ã‚¯ãƒ©ã‚¹ã‚ˆã‚Š**è¦ä»¶ãŒå¤‰ã‚ã‚Šã‚„ã™ã„ã‹**ã€‚
  ï¼ˆå¤‰ã‚ã‚Šã«ãã„ã‚‚ã®ã®ä¾‹ï¼šRubyã®åŸºæœ¬çš„ãªã‚¯ãƒ©ã‚¹ã€ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®ã‚³ãƒ¼ãƒ‰ï¼‰
- **å…·è±¡ã‚¯ãƒ©ã‚¹ã¯**ã€æŠ½è±¡ã‚¯ãƒ©ã‚¹ã‚ˆã‚Š**å¤‰ã‚ã‚‹å¯èƒ½æ€§ãŒé«˜ã„**ã€‚
  ï¼ˆæŠ½è±¡åŒ–ã•ã‚ŒãŸã‚‚ã®ã¸ã®ä¾å­˜ã¯ã€å…·è±¡çš„ãªã‚‚ã®ã¸ã®ä¾å­˜ã‚ˆã‚Šã‚‚å¸¸ã«å®‰å…¨ã€‚ï¼‰
- å¤šãã‹ã‚‰ä¾å­˜ã•ã‚Œã¦ã„ã‚‹ã‚¯ãƒ©ã‚¹ã‚’å¤‰æ›´ã™ã‚‹ã¨ã€åºƒç¯„å›²ã«å½±éŸ¿ãŒã§ã‚‹ã€‚

# 4ç«  æŸ”è»Ÿãªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ã¤ãã‚‹
ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯**ã‚¯ãƒ©ã‚¹ã‹ã‚‰æˆã‚Šç«‹ã¤ãŒã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ã‚ˆã£ã¦å®šç¾©ã•ã‚Œã‚‹**ã€‚
è¨­è¨ˆã§ã¯ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆé–“ã§å—ã‘æ¸¡ã•ã‚Œã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ã¤ã„ã¦ã‚‚è€ƒæ…®ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚
â†’ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒä½•ã‚’çŸ¥ã£ã¦ã„ã‚‹ã‹ï¼ˆè²¬ä»»ï¼‰ã‚„ã€èª°ã‚’çŸ¥ã£ã¦ã„ã‚‹ã‹ï¼ˆä¾å­˜é–¢ä¿‚ï¼‰ã ã‘ã§ãªãã€**ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒäº’ã„ã«ã©ã†ã‚„ã£ã¦ä¼šè©±ã™ã‚‹ã‹ã®è¨­è¨ˆãŒå¿…è¦**ã€‚
â†’ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆé–“ã®ä¼šè©±ã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ä»‹ã—ã¦è¡Œã‚ã‚Œã‚‹ã€‚

## ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®šç¾©ã™ã‚‹
ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã‚’ä¾‹ã«ã—ã¦è¡¨ç¾ã€‚
- *ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã®å¨æˆ¿* = ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãªãƒ¡ã‚½ãƒƒãƒ‰
  ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒæ•°å¤šãå—ã‘æ¸¡ã•ã‚Œã¦ã„ã‚‹
- *ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¡¨* = ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
  ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- *ãŠå®¢ã•ã‚“* = ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
  ã©ã®ã‚ˆã†ã«æ–™ç†ãŒä½œã‚Œã‚‰ã‚Œã¦ã„ã‚‹ã‹ï¼ˆå‡¦ç†ãŒè¡Œã‚ã‚Œã¦ã„ã‚‹ã‹ï¼‰ã¯çŸ¥ã‚‰ãªãã¦ã„ã„ã€‚

ã‚¯ãƒ©ã‚¹å†…ã®**ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãªãƒ¡ã‚½ãƒƒãƒ‰ã¯å®‰å®šã—ãŸéƒ¨åˆ†**ã§ã‚ã‚Šã€**ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãªãƒ¡ã‚½ãƒƒãƒ‰ã¯å¤‰åŒ–ã—å¾—ã‚‹éƒ¨åˆ†**ã€‚

### ã‚ˆã‚Šè‰¯ã„ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
æœ¬æ›¸ã§ã¯ã€è‡ªè»¢è»Šæ—…è¡Œã‚’æä¾›ã™ã‚‹æ—…è¡Œä¼šç¤¾ã®ã‚·ã‚¹ãƒ†ãƒ ã‚’ä¾‹ã«ã—ã¦ã„ã‚‹ã€‚

- å‚åŠ è€…(Customer)
- æ—…è¡Œ(Trip)
- å·¥ç¨‹(Route)
- è‡ªè»¢è»Š(Bike)
- æ•´å‚™å£«(Mechanic)

#### å‚åŠ è€…(Customer)ã¨æ—…è¡Œ(Trip)ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
å‚åŠ è€…ã¯ã€æ—…è¡Œã‚’é¸ã¶ãŸã‚ã«ã€é©åˆ‡ãªé›£æ˜“åº¦ã®ã€ç‰¹å®šã®æ—¥ä»˜ã®ã€è‡ªè»¢è»Šã‚’å€Ÿã‚Šã‚‰ã‚Œã‚‹æ—…è¡Œã®ä¸€è¦§ã‚’è¦‹ãŸã„ã€‚

ã“ã‚Œã‚’ä¸‹è¨˜ã®ã‚ˆã†ã«è¡¨ã™ã€‚ï¼ˆæœ¬æ›¸ã§ã¯ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³ã§è¡¨ã—ã¦ã„ã‚‹ï¼‰
`Customerã‚¯ãƒ©ã‚¹ â†’ suitable_trips(on_date, of_difficuly, need_bike)ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ â†’ Tripã‚¯ãƒ©ã‚¹ (1)`
(Tripã«suitable_tripsãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚ã‚‹)
Tripã«ã€Œè‡ªè»¢è»ŠãŒåˆ©ç”¨å¯èƒ½ã‹ã€ã‚‚èã„ã¦ã„ã‚‹ã€‚ã“ã‚Œã¯ã€TripãŒæ‹…ã†è²¬ä»»ã§ã¯ãªã„ã€‚
â†’**ã“ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚‹å¿…è¦ãŒã‚ã‚‹ãŒã€ã ã‚ŒãŒå¿œç­”ã™ã¹ããªã®ã‹ï¼Ÿã‚’è€ƒãˆã‚‹**ã€‚

è‡ªè»¢è»Šã«ã¤ã„ã¦ã¯ã€Bicycleã«èãã‚ˆã†ã«å¤‰æ›´ã€‚
`Customerã‚¯ãƒ©ã‚¹ â†’ suitable_trips(on_date, of_difficuly)ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ â†’ Tripã‚¯ãƒ©ã‚¹ (2-1)`
`Customerã‚¯ãƒ©ã‚¹ â†’ suitable_bicycle(trip_date, route_type)ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ â†’ Bicycleã‚¯ãƒ©ã‚¹ (2-2)`
Tripã‹ã‚‰ä½™è¨ˆãªè²¬ä»»ã¯å–ã‚Šé™¤ã‘ãŸãŒã€**CustomerãŒã€Œä½•ã‚’æœ›ã‚€ã‹ã€ã ã‘ã§ãªãã€ã€Œã©ã®ã‚ˆã†ã«ã—ã¦æœ›ã‚€ã‚‚ã®ã‚’æº–å‚™ã™ã‚‹ã‹ã€ã¾ã§çŸ¥ã£ã¦ã„ã‚‹**ï¼ˆçŸ¥ã‚Šã™ãã¦ã„ã‚‹ï¼‰ã€‚
ï¼ˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§ä½•ã‚’æœ›ã‚€ã‹æ³¨æ–‡ã™ã‚‹ã®ã§ãªãã€CustomerãŒå¨æˆ¿ã«å…¥ã‚Šã“ã‚“ã§èª¿ç†ã—ã¦ã„ã‚‹ ã‚ˆã†ãªçŠ¶æ³ã€‚ï¼‰

#### æ—…è¡Œ(Trip)ã¨æ•´å‚™å£«(Mechanic)ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
æ—…è¡Œã®å‡ºç™ºå‰ã«ã€è‡ªè»¢è»ŠãŒæ•´å‚™ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ãŸã„ã€‚
`Tripã‚¯ãƒ©ã‚¹ â†” bicyclesãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ (3-1)`
`Tripã‚¯ãƒ©ã‚¹ â†’ clean_bicycle(bike)ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ â†’ Mechanicã‚¯ãƒ©ã‚¹ (3-2)`
`Tripã‚¯ãƒ©ã‚¹ â†’ pump_tires(bike)ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ â†’ Mechanicã‚¯ãƒ©ã‚¹ (3-3)`
`Tripã‚¯ãƒ©ã‚¹ â†’ lude_chain(bike)ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ â†’ Mechanicã‚¯ãƒ©ã‚¹ (3-4)`
`Tripã‚¯ãƒ©ã‚¹ â†’ check_brakes(bike)ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ â†’ Mechanicã‚¯ãƒ©ã‚¹ (3-5)`

TripãŒè‡ªè»¢è»Šã®æ•´å‚™å·¥ç¨‹ã‚’å…¨ã¦çŸ¥ã£ã¦ã„ã‚‹ã€‚(æ‰‹ç¶šãçš„ã§ã‚ã‚‹)
â†’Mechanicã§ã®æ•´å‚™å·¥ç¨‹ãŒè¿½åŠ ãƒ»å¤‰æ›´ã•ã‚Œã‚‹ã¨ã€Tripã‚‚ä¿®æ­£ã—ãªã„ã¨ã„ã‘ãªã„ã€‚

ä¸Šè¨˜ã‚’æ”¹å–„ã€‚
`Tripã‚¯ãƒ©ã‚¹ â†” bicyclesãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ (4-1)`
`Tripã‚¯ãƒ©ã‚¹ â†’ prepare_bicycle(bike)ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ â†’ Mechanicã‚¯ãƒ©ã‚¹ (4-2)`
**ã€Œã©ã®ã‚ˆã†ã«ã—ã¦ã»ã—ã„ã‹ã€ä¼ãˆã‚‹ã®ã§ãªãã€Œä½•ã‚’ã—ã¦ã»ã—ã„ã‹ã€ã‚’é ¼ã‚€**ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã§æ­£ã—ã„æŒ¯ã‚‹èˆã„ã‚’å¾—ã‚‹ã“ã¨ãŒã§ããŸã€‚

MechanicãŒä½•ã‚’ã™ã‚‹ã‹ã‚’çŸ¥ã‚‹ã“ã¨ãªãã€TripãŒMechanicã®æ­£ã—ã„æŒ¯ã‚‹èˆã„ã‚’å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚
`Tripã‚¯ãƒ©ã‚¹ â†’ prepare_trip(self)ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ â†’ Mechanicã‚¯ãƒ©ã‚¹ â†’ bicyclesã‚’è¿”å´ (5-1)`
`Tripã‚¯ãƒ©ã‚¹ â†’ prepare_bicycle(bike)ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ â†’ Mechanicã‚¯ãƒ©ã‚¹ (5-2)`
ã©ã®è‡ªè»¢è»Šã‚’ç”¨æ„ã™ã‚‹ã®ã‹ ã‚’ã€Tripè‡ªèº«ã§ãªãMechanicã«èãã‚ˆã†ã«ã—ã¦ã„ã‚‹ã€‚
ã“ã®çŠ¶æ…‹ã§ã¯ã€Tripã¯Mechanicã«ã¤ã„ã¦ä½•ã‚‚çŸ¥ã‚‰ãªã„ã€‚Mechanicã«**ä½•ã‚’ã—ã¦ã»ã—ã„ã‹**ã‚’selfã‚’å¼•æ•°ã«ã—ã¦ä¼ãˆã¦ã„ã‚‹ã€‚
æ•´å‚™å£«ãŒã©ã®ã‚ˆã†ã«æ—…è¡Œã‚’æº–å‚™ã™ã‚‹ã®ã‹ã¯ã€ã™ã¹ã¦Mechanicå†…ã«éš”é›¢ã™ã‚‹ã“ã¨ãŒã§ããŸã€‚

#### å…¨ä½“
å‚åŠ è€…(Customer)ã¨æ—…è¡Œ(Trip)ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è©±ã«æˆ»ã‚‹ã€‚
(1)ï¼šTripã«ã€Œè‡ªè»¢è»ŠãŒåˆ©ç”¨å¯èƒ½ã‹ã€ã‚‚èã„ã¦ã„ã¦ã€ã“ã‚Œã¯TripãŒæ‹…ã†è²¬ä»»ã§ã¯ãªã„ã€‚
(2)ï¼šCustomerãŒ(ã©ã†ã‚„ã£ã¦ç”¨æ„ã™ã‚‹ã‹ã¾ã§)çŸ¥ã‚Šã™ãã¦ã„ã‚‹ã€‚
ã“ã‚“ãªçŠ¶æ³ã§æ­¢ã¾ã£ã¦ã„ãŸã€‚

ã“ã‚Œã‚’è§£æ±ºã™ã‚‹ã«ã¯ã€
**ã€Œé©åˆ‡ãªæ—…è¡Œã®ä¸€è¦§ã€ã¨ã€Œè‡ªè»¢è»ŠãŒæº–å‚™ã§ãã¦ã„ã‚‹ã‹ã€ã‚’èãã“ã¨ãŒã§ã**ã€(*å¨æˆ¿ã§ä½•ã‚’ã™ã‚‹ã‹çŸ¥ã£ã¦ã„ã¦*)
**Customerã«ã¯æœ›ã¿ã ã‘ã‚’èãã“ã¨ãŒã§ãã‚‹**(*ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’æä¾›ã§ãã‚‹*)
ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ç”¨æ„ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚

ãã“ã§ã€TripFinderã‚¯ãƒ©ã‚¹ã‚’ç”¨æ„ã™ã‚‹ã“ã¨ãŒé©åˆ‡ã¨è€ƒãˆã‚‹ã€‚
`Customerã‚¯ãƒ©ã‚¹ â†’ suitable_trips(on_date, of_difficuly, need_bike)ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ â†’ TripFinderã‚¯ãƒ©ã‚¹ (6-1)`
`TripFinderã‚¯ãƒ©ã‚¹ â†’ suitable_trips(on_date, of_difficuly)ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ â†’ Tripã‚¯ãƒ©ã‚¹ (6-2)`
`TripFinderã‚¯ãƒ©ã‚¹ â†’ suitable_bicycle(trip_date, route_type)ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ â†’ Bicycleã‚¯ãƒ©ã‚¹ (6-3)`

### ä¸€ç•ªè‰¯ã„é¢(ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹)ã‚’è¡¨ã«å‡ºã™ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã
**ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®æ˜å¿«ã•ã¯ã€è¨­è¨ˆã‚¹ã‚­ãƒ«ã‚’è¡¨ã™**ã€‚

ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¯ã€ä¸‹è¨˜ã®ã‚ˆã†ã«ã‚ã‚‹ã¹ãã€‚
- **ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‹ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‹ãŒæ˜ã‚‰ã‹**ã€‚
- **ã€Œã©ã®ã‚ˆã†ã«ã€ã§ãªãã€Œä½•ã‚’ã€ã«ãªã£ã¦ã„ã‚‹**ã€‚
- **åå‰ã¯å¤‰ã‚ã‚Šå¾—ãªã„**ã€‚ï¼ˆè€ƒãˆã‚‰ã‚Œã‚‹é™ã‚Šï¼‰
- **ã‚ªãƒ—ã‚·ãƒ§ãƒ³å¼•æ•°ã¨ã—ã¦ãƒãƒƒã‚·ãƒ¥ã‚’ã¨ã‚‹**ã€‚

### ãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
Rubyã«ã¯ä¸‹è¨˜3ç¨®ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ãŒã‚ã‚‹ã€‚
- `public` : åˆ¶é™ãªã—ã€‚ã‚¯ãƒ©ã‚¹ã®å¤–ã‹ã‚‰ã§ã‚‚å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã‚‹ã€‚
- `private` : ã‚¯ãƒ©ã‚¹å†…ã§ã®ã¿å‘¼ã³å‡ºã›ã‚‹ã€‚ã‚¯ãƒ©ã‚¹ã®å¤–ã‹ã‚‰å‘¼ã³å‡ºã›ãªã„ã€‚
- `protected` : ã‚¯ãƒ©ã‚¹å†…+*åŒã˜ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹*ãªã‚‰å‘¼ã³å‡ºã›ã‚‹ã€‚(ç‰¹æ®Š)

ï¼ˆä¸‹è¨˜ã‚µã‚¤ãƒˆãŒã‚ã‹ã‚Šã‚„ã™ãè§£èª¬ã—ã¦ã„ãŸï¼‰
https://26gram.com/private-protected-in-ruby
https://qiita.com/tbpgr/items/6f1c0c7b77218f74c63e

ã“ã‚Œã‚‰ã®åˆ¶å¾¡ã‚’ä½¿ã†ç”¨é€”ã¯ä¸‹è¨˜2ã¤ã§ã‚ã‚Šã€å…¨ãç•°ãªã‚‹ã‚‚ã®ã§ã‚ã‚‹ã€‚
1. **ã©ã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒå®‰å®šã—ã¦ã„ã¦ã€ã©ã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒä¸å®‰å®šã‹** ã‚’ç¤ºã™ãŸã‚ã€‚
  `private`ãŒæœ€ã‚‚ä¸å®‰å®šã€‚ï¼ˆpublicãŒå®‰å®šã€‚ï¼‰
2. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®**ã»ã‹ã®ã¨ã“ã‚ã«ã€ã©ã‚Œã ã‘ãƒ¡ã‚½ãƒƒãƒ‰ãŒè¦‹ãˆã‚‹ã‹** ã‚’åˆ¶å¾¡ã™ã‚‹ãŸã‚ã€‚

:::message
ã“ã‚Œã‚‰ã¯ã€ã‚¢ã‚¯ã‚»ã‚¹ã‚’**æ‹’å¦ã™ã‚‹è¨³ã§ã¯ãªãã€ãŸã å¤§å¤‰ã«ã™ã‚‹**ã®ã¿ã€‚ãã“ã‚’å‹˜é•ã„ã—ãªã„ã“ã¨ã€‚
ï¼ˆçµ¶å¯¾çš„ãªåˆ¶é™ã§ãªã„ãŸã‚ã€ã ã‚Œã§ã‚‚ãã®éšœå£ã‚’è¶…ãˆã‚‹ã“ã¨ã¯ã§ãã‚‹ã€‚ï¼‰
:::
ãã‚Œã§ã‚‚ä½¿ã†ã®ã¯ã€ä¸Šè¨˜1.ã®é€šã‚Š**ãã®ãƒ¡ã‚½ãƒƒãƒ‰ã®å®‰å®šæ€§ã‚’ç¤ºã™ãŸã‚**ã§ã‚ã‚‹ã€‚

### ãƒ‡ãƒ¡ãƒ†ãƒ«ã®æ³•å‰‡
**3ã¤ç›®ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚‹éš›ã«ã€ç•°ãªã‚‹å‹ã®2ã¤ç›®ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä»‹ã™ã‚‹ã“ã¨ã‚’ç¦æ­¢ã™ã‚‹**ã€‚
ï¼ˆç›´æ¥ã®éš£äººã«ã®ã¿è©±ã—ã‹ã‘ã‚ˆã†ã€ãƒ‰ãƒƒãƒˆã¯1ã¤ã¾ã§ã«ã—ã‚ˆã† ã¨è¡¨ç¾ã•ã‚Œã‚‹ã€‚ï¼‰

```ruby:æ‚ªã„ä¾‹
customer.bicycle.wheel.tire
```
ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒã‚§ãƒ¼ãƒ³å†…ã®ã©ã“ã‹ã§èµ·ãã‚‹é–¢ä¿‚ã®ãªã„å¤‰æ›´ã«ã‚ˆã£ã¦ã€å¤‰æ›´ã‚’ä¸å„€ãªãã•ã‚Œã‚‹ãƒªã‚¹ã‚¯ãŒé«˜ã¾ã£ã¦ã„ã‚‹ã€‚

# 5ç«  ãƒ€ãƒƒã‚¯ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ã§ã‚³ã‚¹ãƒˆã‚’å‰Šæ¸›ã™ã‚‹
å‹•çš„å‹ä»˜ã‘ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã§ä½¿ã‚ã‚Œã‚‹å‹ä»˜ã‘ã®ã‚„ã‚Šæ–¹ã®ã“ã¨ã€‚
ï¼ˆç”±æ¥ï¼šãã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒã‚¢ãƒ’ãƒ«ã®ã‚ˆã†ã«é³´ãã€ã‚¢ãƒ’ãƒ«ã®ã‚ˆã†ã«æ­©ããªã‚‰ã°ã€ãã®ã‚¯ãƒ©ã‚¹ãŒä½•ã§ã‚ã‚Œã€ãã‚Œã¯ã‚¢ãƒ’ãƒ«ã§ã‚ã‚‹ã€‚ï¼‰

## ãƒ€ãƒƒã‚¯ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ã‚’ç†è§£ã™ã‚‹
### ãƒ€ãƒƒã‚¯ã‚’è¦‹é€ƒã™
ä»¥ä¸‹ã¯ã€ãƒ€ãƒƒã‚¯ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ã™ã‚‹å‰ã®ã‚³ãƒ¼ãƒ‰ã€‚
```ruby
class Trip
  attr_reader :bicycles, :customers, :vehicle

  # å¼•æ•°ã®mechanicã¯ã€ã©ã‚“ãªã‚¯ãƒ©ã‚¹ã®ã‚‚ã®ã§ã‚‚è‰¯ã„ã“ã¨ã«ãªã£ã¦ã„ã‚‹
  def prepare(mechanic)
    # ã—ã‹ã—ã€mechanicãŒprepare_bicyclesã«å¿œç­”ã™ã‚‹ã¯ãšã ã¨ä¿¡ã˜ã¦ã„ã‚‹
    # â†’ prepare_bicyclesã«å¿œç­”ã§ãã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒæ¸¡ã•ã‚Œã‚‹ ã“ã¨ã«ä¾å­˜ã—ã¦ã„ã‚‹
    mechanic.prepare_bicycles(bicycles)
  end
end

class Mechanic
  def prepare_bicycles(bicycles)
    bicycles.each {|bicycle| prepare_bicycle(bicycle)}
  end

  def prepare_bicycle(bicycle)
    # ä½•ã‹ã®å‡¦ç†
  end
end
```

### å•é¡Œã‚’æ‚ªåŒ–ã•ã›ã‚‹
ã‚ãˆã¦å•é¡Œã‚’æ‚ªåŒ–ã•ã›ã¦è€ƒãˆã‚‹ãŸã‚ã«ã€ä¸‹è¨˜ã®ã‚ˆã†ã«è¦ä»¶ãŒå¤‰ã‚ã£ãŸã¨ã™ã‚‹ã€‚
ã€Œæ—…è¡Œã®æº–å‚™ã«ã¯ã€æ•´å‚™å£«ã«åŠ ãˆã€æ—…è¡Œã®ã‚³ãƒ¼ãƒ‡ã‚£ãƒãƒ¼ã‚¿ãƒ¼ã¨é‹è»¢æ‰‹ã‚‚å¿…è¦ã«ãªã£ãŸã€
```ruby
class Trip
  attr_reader :bicycles, :customers, :vehicle

  def prepare(preparers)
    preparers.each {|preparer|
      # prepare_bicyclesã«å¿œç­”ã§ããªã„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã‚‚å¯¾å¿œã™ã‚‹ãŸã‚caseæ–‡ã§å ´åˆåˆ†ã‘
      case preparer
      when Mechanic
        preparer.prepare_bicycles(bicycles)
      when TripCoordinator
        preparer.buy_food(customers)
      when Driver
        preparer.gas_up(vehicle)
      end
    }
  end
end

# (ãã®ä»–ã®ã‚¯ãƒ©ã‚¹ã¯ç•¥)
```
ã“ã“ã§ã®å•é¡Œç‚¹ã¯ã€**TripãŒå…·è±¡ã‚¯ãƒ©ã‚¹ã¨ãã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’çŸ¥ã‚Šã™ãã¦ã„ã‚‹**ã“ã¨ã€‚

### ãƒ€ãƒƒã‚¯ã‚’è¦‹ã¤ã‘ã‚‹
ãƒ€ãƒƒã‚¯ã‚’è¦‹ã¤ã‘ã‚‹æ€è€ƒã‚’ä¸‹è¨˜ã«ç¤ºã™ã€‚
1. ä¾å­˜ã‚’å–ã‚Šé™¤ã(ãƒ€ãƒƒã‚¯ã‚’è¦‹ã¤ã‘ã‚‹)éµã¨ãªã‚‹ã®ã¯ã€ã€ŒTripã‚¯ãƒ©ã‚¹ã®prepareãƒ¡ã‚½ãƒƒãƒ‰ã¯å˜ä¸€ã®ç›®çš„ã‚’é”æˆã™ã‚‹ãŸã‚ã«ã‚ã‚‹ã®ã§ã€ãã®**å¼•æ•°ã‚‚å˜ä¸€ã®ç›®çš„ã‚’é”æˆã™ã‚‹ãŸã‚ã«æ¸¡ã•ã‚Œã¦ãã‚‹**ã€ã¨èªè­˜ã™ã‚‹ã“ã¨ã€‚
2. prepareã®ç›®çš„ã¯ã€æ—…è¡Œã‚’æº–å‚™ã™ã‚‹ã“ã¨ã€‚
3. ãã®å¼•æ•°ã‚‚ã€æ—…è¡Œã®æº–å‚™ã«å”åŠ›ã—ã‚ˆã†ã¨ã‚„ã£ã¦ãã‚‹(æ¸¡ã•ã‚Œã¦ãã‚‹)ã€‚ã¤ã¾ã‚Šã€**å¼•æ•°ã¯ã™ã¹ã¦æº–å‚™ã™ã‚‹ã‚‚ã®(Preparer)ã **ã¨è€ƒãˆã‚‹
4. **Tripã¯Preparer(æ•´å‚™å£«ã€ã‚³ãƒ¼ãƒ‡ã‚£ãƒãƒ¼ã‚¿ãƒ¼ã€é‹è»¢æ‰‹)ã«ä½•ã‚’ã—ã¦ã»ã—ã„ã‹**ã€‚ãã‚Œã¯**æ—…è¡Œã«è¡ŒããŸã‚ã®æº–å‚™(prepare_trip)**ã€‚
5. ã‚ˆã£ã¦ã€**Preparerã¯çš†ã€prepare_tripã«å¿œç­”ã§ãã‚Œã°ã„ã„**ã€‚
:::message alert
**å®Ÿéš›ã«Preparerã‚¯ãƒ©ã‚¹ã‚’ä½œã‚‹ã®ã§ã¯ãªã„**ã€‚ãƒ€ãƒƒã‚¯ã‚¿ã‚¤ãƒ—ã¯æ¦‚å¿µã€‚
:::

```ruby
class Trip
  attr_reader :bicycles, :customers, :vehicle

  def prepare(preparers)
    preparers.each { |preparer| preparer.prepare_trip(self) }
  end
end

class Mechanic
  def prepare_trip(trip)
    trip.bicycles.each { |bicycle| prepare_bicycle(bicycle) }
  end

  def prepare_bicycle(bicycle)
    # ä½•ã‹ã®å‡¦ç†
  end
end

class TripCoordinator
  def prepare_trip(trip)
    buy_food(trip.customers)
  end
  
  # ...
end

class Driver
  def prepare_trip(trip)
    gas_up(trip.vehicle)
  end
  
  # ...
end
```

:::message
### ãƒãƒªãƒ¢ãƒ¼ãƒ•ã‚£ã‚ºãƒ 
å¤šå²ã«ã‚ãŸã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒã€åŒã˜ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«å¿œç­”ã§ãã‚‹èƒ½åŠ›ã€‚
:::

## éš ã‚ŒãŸãƒ€ãƒƒã‚¯ã‚’è¦‹ã¤ã‘ã‚‹
æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰å†…ã«ãƒ€ãƒƒã‚¯ã‚¿ã‚¤ãƒ—ãŒæ½œã‚“ã§ã„ã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚
ã‚ˆãä½¿ã‚ã‚Œã‚‹ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ä¸­ã«ã¯ã€ãã®å­˜åœ¨ã‚’ç¤ºå”†ã™ã‚‹ã‚‚ã®ãŒã‚ã‚‹ã€‚
- ã‚¯ãƒ©ã‚¹ã§åˆ†å²ã™ã‚‹caseæ–‡
- `kind_of?`ã¨`is_a?`
- `responds_to?`

### ã‚¯ãƒ©ã‚¹ã§åˆ†å²ã™ã‚‹caseæ–‡
å‰è¿°ã®ã‚³ãƒ¼ãƒ‰ã§ç¤ºã—ãŸå†…å®¹ã€‚(ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¯ãƒ©ã‚¹ã«ã‚ˆã£ã¦åˆ†å²ã•ã›ã¦ã„ãŸã€‚)

### `kind_of?`ã¨`is_a?`
`kind_of?`ã¨`is_a?`ã‚‚ã€ãã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¯ãƒ©ã‚¹ã‚’ç¢ºèªã™ã‚‹ã‚‚ã®ãªã®ã§ã€ä¸Šè¨˜ã¨åŒã˜ã€‚

### `responds_to?`
`responds_to?`ã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚ã‚‹ã‹èª¿ã¹ã‚‹ã€‚
ãã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¯ãƒ©ã‚¹ã‚’ç¢ºèªã™ã‚‹ã“ã¨ã¨ã€ãã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«å¿œç­”ã™ã‚‹ã‹ã©ã†ã‹ç¢ºèªã™ã‚‹ã“ã¨ã¯ã€ã“ã®æ–‡è„ˆä¸ŠåŒã˜ã€‚(ãã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒä½•ã‚’å®Ÿè¡Œã§ãã‚‹ã‹çŸ¥ã£ã¦ã„ã‚‹)

# 6ç«  ç¶™æ‰¿ã«ã‚ˆã£ã¦æŒ¯ã‚‹èˆã„ã‚’ç²å¾—ã™ã‚‹
ç¶™æ‰¿ã—ãŸã‚¯ãƒ©ã‚¹ãŒå¿œç­”ã§ããªã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸(ãƒ¡ã‚½ãƒƒãƒ‰ãŒç„¡ã„å ´åˆ)ã¯ã€è¦ªã‚¯ãƒ©ã‚¹(ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚¯ãƒ©ã‚¹)ã«è‡ªå‹•çš„ã«å•ã„åˆã‚ã›ã‚‹ã€‚
(è‡ªåˆ†ã§å¿œç­”ã§ãã‚‹å ´åˆã¯å½“ç„¶ã€è‡ªåˆ†ã§å¿œç­”ã™ã‚‹ã€‚)
##### ä¾‹ï¼šRubyã®nil?ãƒ¡ã‚½ãƒƒãƒ‰
ã™ã¹ã¦ã®ã‚¯ãƒ©ã‚¹ã®è¦ªã‚¯ãƒ©ã‚¹ã§ã‚ã‚‹*Objectã‚¯ãƒ©ã‚¹*ã«ã¯`nil? -> false`ã¨å®šç¾©ã—ã¦ã‚ã‚‹ã€‚
*Nillã‚¯ãƒ©ã‚¹*ã«ã¯`nil? -> true`ã¨å®šç¾©ã•ã‚Œã¦ã‚ã‚‹ã€‚
ãã†ã™ã‚‹ã“ã¨ã§ã€Nillã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹.nil?ã¯trueã«ã€ãã®ä»–ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯falseã‚’è¿”ã™ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã€‚

## ç¶™æ‰¿ã‚’ä½¿ã†ã¹ãç®‡æ‰€ã‚’è­˜åˆ¥ã™ã‚‹
ä»¥ä¸‹ã€2ç¨®é¡ã®è‡ªè»¢è»Šï¼ˆãƒ­ãƒ¼ãƒ‰ãƒã‚¤ã‚¯ã€ãƒã‚¦ãƒ³ãƒ†ãƒ³ãƒã‚¤ã‚¯ï¼‰ã‚’ä¾‹ã«ã™ã‚‹ã€‚

### è¤‡æ•°ã®å‹ã‚’åŸ‹ã‚è¾¼ã‚€å®šç¾©ã—ãŸã‚¯ãƒ©ã‚¹
```ruby:1ã¤ã®ã‚¯ãƒ©ã‚¹ã«2ã¤ã®å‹ã‚’åŸ‹ã‚è¾¼ã‚“ã 
class Bicycle
  attr_reader :style, :size, :tape_color, :front_shock, :rear_shock

  def initialize(args)
    @style = args[:style] # è‡ªè»¢è»Šã®ç¨®é¡
    @size = args[:size] # è‡ªè»¢è»Šã®ã‚µã‚¤ã‚º
    @tape_color = args[:tape_color] # ãƒãƒ³ãƒ‰ãƒ«ãƒ†ãƒ¼ãƒ—ã®è‰²
    @front_shock = args[:front_shock] # å‰ã®ã‚µã‚¹ãƒšãƒ³ã‚·ãƒ§ãƒ³(ãƒã‚¦ãƒ³ãƒ†ãƒ³ãƒã‚¤ã‚¯ç‰¹æœ‰)
    @rear_shock = args[:rear_shock] # å¾Œã‚ã®ã‚µã‚¹ãƒšãƒ³ã‚·ãƒ§ãƒ³(ãƒã‚¦ãƒ³ãƒ†ãƒ³ãƒã‚¤ã‚¯ç‰¹æœ‰)
  end

  # ã‚¹ãƒšã‚¢ã¨ã—ã¦ç”¨æ„ã™ã‚‹ã‚‚ã®
  def spares
    if style == :road
      # ãƒ­ãƒ¼ãƒ‰ãƒã‚¤ã‚¯ã®å ´åˆ
      {
        chain: '10-speed',
        tire_size: '23',
        tape_color: tape_color
      }
    else
      # ãƒ­ãƒ¼ãƒ‰ãƒã‚¤ã‚¯ä»¥å¤–(ãƒã‚¦ãƒ³ãƒ†ãƒ³ãƒã‚¤ã‚¯)ã®å ´åˆ
      {
        chain: '10-speed',
        tire_size: '2.1',
        rear_shock: rear_shock
      }
    end
  end
end

bike = Bicycle.new(
  style: :mountain,
  size: 'S',
  front_shock: 'Manitou',
  rear_shock: 'Fox'
)
p bike.spares
```

### ç¶™æ‰¿ã‚’ä¸é©åˆ‡ã«ä½¿ã†
```ruby
class MountainBike < Bicycle
  attr_reader :front_shock, :rear_shock

  def initialize(args)
    @front_shock = args[:front_shock] # å‰ã®ã‚µã‚¹ãƒšãƒ³ã‚·ãƒ§ãƒ³(ãƒã‚¦ãƒ³ãƒ†ãƒ³ãƒã‚¤ã‚¯ç‰¹æœ‰)
    @rear_shock = args[:rear_shock] # å¾Œã‚ã®ã‚µã‚¹ãƒšãƒ³ã‚·ãƒ§ãƒ³(ãƒã‚¦ãƒ³ãƒ†ãƒ³ãƒã‚¤ã‚¯ç‰¹æœ‰)
    super(args) # è¦ªã‚¯ãƒ©ã‚¹ã®åŒãƒ¡ã‚½ãƒƒãƒ‰å‘¼ã³å‡ºã—
  end

  def spares
    super.merge(rear_shock: rear_shock)
  end
end
```
ã“ã®ã‚ˆã†ã«ã‚¯ãƒ©ã‚¹ã‚’å®šç¾©ã—ã¦ã¯ã„ã‘ãªã„ã€‚
ãªãœãªã‚‰ã€BicycleãŒå…·è±¡ã‚¯ãƒ©ã‚¹ã®ã¾ã¾ã§ã€Bicycleã«ã¯ãƒ­ãƒ¼ãƒ‰ãƒã‚¤ã‚¯ãŒã¾ã å«ã¾ã‚Œã¦ã„ã‚‹ã€‚
ã¤ã¾ã‚Šã€MountainBike(å…·è±¡ã‚¯ãƒ©ã‚¹)ãŒãƒ­ãƒ¼ãƒ‰ãƒã‚¤ã‚¯ã®æŒ¯ã‚‹èˆã„ã‚’ç¶™æ‰¿ã—ã¦ã—ã¾ã£ã¦ã„ã‚‹ã€‚
â†’ Bicycle(è¦ªã‚¯ãƒ©ã‚¹)ã‚’æŠ½è±¡ã‚¯ãƒ©ã‚¹ã«ã—ã¦ã€RoadBikeã‚’Bicycleã‹ã‚‰åˆ†é›¢ã™ã¹ãã€‚

:::message
**ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã¯ãã®ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚¯ãƒ©ã‚¹ã‚’ç‰¹åŒ–ã—ãŸã‚‚ã®**ã€‚
:::

:::message
#### ç¶™æ‰¿ã®ãƒ«ãƒ¼ãƒ«
1. **æ±åŒ–-ç‰¹åŒ–ã®é–¢ä¿‚**ã§ã‚ã‚‹ã“ã¨ã€‚
2. æ­£ã—ã„ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’ä½¿ã£ã¦ã„ã‚‹ã“ã¨ã€‚
:::

### æŠ½è±¡çš„ãªè¦ªã‚¯ãƒ©ã‚¹ã‚’ã¤ãã‚‹
Bicycleã‹ã‚‰åˆ†é›¢ã—ã€RoadBikeã‚¯ãƒ©ã‚¹ã‚’æ–°è¦ã§ä½œæˆã€‚
```ruby
class Bicycle
  attr_reader :size, :chain, :tire_size

  def initialize(args = {})
    @size = args[:size] # è‡ªè»¢è»Šã®ã‚µã‚¤ã‚º
    @chain = args[:chain]
    @tire_size = args[:tire_size]
  end

  def spares
    {
      chain: chain,
      tire_size: tire_size,
    }
  end
end

class RoasBike < Bicycle
  attr_reader :tape_color

  def initialize(args)
    @tape_color = args[:tape_color] # ãƒãƒ³ãƒ‰ãƒ«ãƒ†ãƒ¼ãƒ—ã®è‰²
    super(args) # è¦ªã‚¯ãƒ©ã‚¹ã®åŒãƒ¡ã‚½ãƒƒãƒ‰å‘¼ã³å‡ºã—
  end

  def spares
    # {
    #   chain: '10-speed',
    #   tire_size: '23',
    #   tape_color: tape_color
    # }
    super.merge(tape_color: tape_color)
  end
end

class MountainBike < Bicycle
  attr_reader :front_shock, :rear_shock

  def initialize(args)
    @front_shock = args[:front_shock] # å‰ã®ã‚µã‚¹ãƒšãƒ³ã‚·ãƒ§ãƒ³(ãƒã‚¦ãƒ³ãƒ†ãƒ³ãƒã‚¤ã‚¯ç‰¹æœ‰)
    @rear_shock = args[:rear_shock] # å¾Œã‚ã®ã‚µã‚¹ãƒšãƒ³ã‚·ãƒ§ãƒ³(ãƒã‚¦ãƒ³ãƒ†ãƒ³ãƒã‚¤ã‚¯ç‰¹æœ‰)
    super(args) # è¦ªã‚¯ãƒ©ã‚¹ã®åŒãƒ¡ã‚½ãƒƒãƒ‰å‘¼ã³å‡ºã—
  end

  def spares
    # {
    #   chain: '10-speed',
    #   tire_size: '2.1',
    #   rear_shock: rear_shock
    # }
    super.merge(rear_shock: rear_shock)
  end
end
```

### ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½¿ã†
#### ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ãƒ‘ã‚¿ãƒ¼ãƒ³
è¦ªã‚¯ãƒ©ã‚¹ã§æŠ½è±¡çš„ã«æ±ºã‚ã¦ã€å­ã‚¯ãƒ©ã‚¹ã§è©³ç´°ã‚’åŸ‹ã‚ã‚‹ã€‚
```diff ruby
class Bicycle
  attr_reader :size, :chain, :tire_size

  def initialize(args = {})
    @size = args[:size]
    # åˆæœŸå€¤ã¨ã—ã¦æ¸¡ã•ã‚Œãªã„é™ã‚Šã¯ã€è‡ªè»¢è»Šå…±é€šã®å€¤ã‚’æ¡ç”¨ã™ã‚‹
-   @chain = args[:chain]
+   @chain = args[:chain] || default_chain
    # åˆæœŸå€¤ã¨ã—ã¦æ¸¡ã•ã‚Œãªã„é™ã‚Šã¯ã€å„è‡ªè»¢è»Šã§æŒ‡å®šã—ã¦ã„ã‚‹ç‰¹æœ‰ã®å€¤ã‚’æ¡ç”¨ã™ã‚‹
-   @tire_size = args[:tire_size]
+   @tire_size = args[:tire_size] || default_tire_size
  end

+ def default_chain
+   '10-speed' # ã©ã‚“ãªè‡ªè»¢è»Šã§ã‚‚å…±é€šã®åˆæœŸå€¤
+ end

  def spares
    {
      chain: chain,
      tire_size: tire_size
    }
  end
end

class RoasBike < Bicycle
  attr_reader :tape_color

  def initialize(args)
    @tape_color = args[:tape_color]
    super(args)
  end

+ def default_tire_size
+   '23' # ãƒ­ãƒ¼ãƒ‰ãƒã‚¤ã‚¯ç‰¹æœ‰ã®åˆæœŸå€¤
+ end

  def spares
    super.merge(tape_color: tape_color)
  end
end

class MountainBike < Bicycle
  attr_reader :front_shock, :rear_shock

  def initialize(args)
    @front_shock = args[:front_shock]
    @rear_shock = args[:rear_shock]
    super(args)
  end

+ def default_tire_size
+   '2.1' # ãƒã‚¦ãƒ³ãƒ†ãƒ³ãƒã‚¤ã‚¯ç‰¹æœ‰ã®åˆæœŸå€¤
+ end

  def spares
    super.merge(rear_shock: rear_shock)
  end
end
```

### ã™ã¹ã¦ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å®Ÿè£…ã™ã‚‹
ä¸Šã®å®Ÿè£…ã§å„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒå­˜åœ¨ã™ã¹ãå ´æ‰€ã«å­˜åœ¨ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸãŒã€æ–°ãŸãªå…·è±¡ã‚¯ãƒ©ã‚¹ã‚’ä½œã‚‹ã¨ãã«å•é¡Œã‚’å¼•ãèµ·ã“ã™å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚
å…·è±¡ã‚¯ãƒ©ã‚¹ã«ã¯`default_tire_size`ã®å®Ÿè£…ãŒå¿…é ˆã ãŒã€ãã®ã“ã¨ã‚’çŸ¥ã‚‰ãšã«æ–°ãŸãª`***Bike`ã‚¯ãƒ©ã‚¹ã‚’ä½œã‚Šã€ç‰¹ã«`tire_size`ã‚’æŒ‡å®šã›ãšåˆæœŸåŒ–ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ãŒèµ·ã“ã‚‹ã€‚
â†’ **ä¸€è¦‹ã—ãŸã ã‘ã§ã¯æŠŠæ¡ã§ããªã„è¦ä»¶(`default_tire_size`ãŒå¿…é ˆ)ã‚’ã€è¦ªã‚¯ãƒ©ã‚¹ãŒå­ã‚¯ãƒ©ã‚¹ã«èª²ã—ã¦ã„ã‚‹**ã€‚

```diff ruby
class Bicycle
  attr_reader :size, :chain, :tire_size

  def initialize(args = {})
    @size = args[:size]
    # åˆæœŸå€¤ã¨ã—ã¦æ¸¡ã•ã‚Œãªã„é™ã‚Šã¯ã€è‡ªè»¢è»Šå…±é€šã®å€¤ã‚’æ¡ç”¨ã™ã‚‹
    @chain = args[:chain] || default_chain
    # åˆæœŸå€¤ã¨ã—ã¦æ¸¡ã•ã‚Œãªã„é™ã‚Šã¯ã€å„è‡ªè»¢è»Šã§æŒ‡å®šã—ã¦ã„ã‚‹ç‰¹æœ‰ã®å€¤ã‚’æ¡ç”¨ã™ã‚‹
    @tire_size = args[:tire_size] || default_tire_size
  end

+ def default_tire_size
+   # ãªãœã‚¨ãƒ©ãƒ¼ãŒèµ·ããŸã®ã‹æ˜ç¢ºã«ã™ã‚‹
+   raise NotImplementedError, "#{self.class}ã‚¯ãƒ©ã‚¹ã¯ã“ã®ãƒ¡ã‚½ãƒƒãƒ‰ã«å¿œç­”ã§ããªã„:"
+ end

  # ç•¥
end
# ç•¥
```

### ãƒ•ãƒƒã‚¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä½¿ã£ã¦å­ã‚¯ãƒ©ã‚¹ã‚’ç–çµåˆã«ã™ã‚‹
ä¸Šã®ã‚³ãƒ¼ãƒ‰ã«ãŠã„ã¦ã‚‚æ”¹å–„ç‚¹ãŒã‚ã‚Šã€ãã‚Œã¯å­ã‚¯ãƒ©ã‚¹ã®`initialize`ã€‚
è¦ªã‚¯ãƒ©ã‚¹ãŒhashã‚’è¿”ã™ã“ã¨(ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ )ã‚’çŸ¥ã£ã¦ã„ã‚‹ã“ã¨ãŒã¾ãšã„ã€‚
(ä¾‹ãˆã°ã€æ–°ã—ã„å­ã‚¯ãƒ©ã‚¹`RecumbentBike`ã‚’ä½œã‚Šã€`initialize`ã§`super`ã‚’æ›¸ãå¿˜ã‚Œã‚‹ã¨ã€æŒ‡å®šã—ãŸå€¤ãŒåˆæœŸå€¤ã¨ã—ã¦è¨­å®šã•ã‚Œãšnilã¨ãªã‚‹ã€‚)

*å­ã‚¯ãƒ©ã‚¹ã‹ã‚‰è¦ªã‚¯ãƒ©ã‚¹ã«superã‚’é€ã‚‹ã‚ˆã†ã«(è¦ªã‚¯ãƒ©ã‚¹ãŒ)æ±‚ã‚ã‚‹*ã®ã§ãªãã€**è¦ªã‚¯ãƒ©ã‚¹ãŒå­ã‚¯ãƒ©ã‚¹ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚‹ã‚ˆã†ã«ã™ã‚‹**ã“ã¨ã§ã€ãã‚Œã‚’è§£æ¶ˆã™ã‚‹ã€‚
```diff ruby
class Bicycle
  attr_reader :size, :chain, :tire_size

  def initialize(args = {})
    @size = args[:size]
    @chain = args[:chain] || default_chain
    @tire_size = args[:tire_size] || default_tire_size

+   post_initialize(args)
    # -> å­ã‚¯ãƒ©ã‚¹ã«post_initializeãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚‹(ç„¡ã‘ã‚Œã°ã“ã®ã‚¯ãƒ©ã‚¹ã®post_initializeã«)
  end

+ def post_initialize(args)
+   nil
+ end
  
  # ç•¥
end

class RoasBike < Bicycle
  attr_reader :tape_color

- def initialize(args)
+ def post_initialize(args)
    @tape_color = args[:tape_color]
-   super(args) # -> è¦ªã‚¯ãƒ©ã‚¹ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚‰ãªãã¦è‰¯ããªã£ãŸ
  end

  # ç•¥
end
```
